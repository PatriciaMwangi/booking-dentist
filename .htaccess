# 1. Protect sensitive files
<FilesMatch "^\.env|Composer\.json|Docker|README\.md">
    Order allow,deny
    Deny from all
</FilesMatch>

# 2. Enable Routing Engine
RewriteEngine On

# 3. Block direct access to .php files (Forces use of clean URLs)
# This rule is now relative to the current folder
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s([^?]+)\.php [NC]
RewriteRule ^ %1 [R=301,L]

# 4. Route everything to index.php
# We remove 'RewriteBase /' to let Apache auto-detect the folder
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ index.php [L]